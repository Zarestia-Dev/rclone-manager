<div class="password-section">
  <!-- Error banner - always in DOM, animated via CSS -->
  <div class="error-banner" [class.visible]="hasError()" [attr.data-error-count]="errorCount()">
    <mat-icon svgIcon="warning"></mat-icon>
    <span>{{ errorMessage() }}</span>
  </div>

  <div class="password-form">
    <mat-form-field appearance="fill" class="password-field">
      <mat-label>{{ label() }}</mat-label>
      <mat-icon
        matPrefix
        svgIcon="key"
        [matTooltip]="isSubmitting() ? 'Verifying...' : 'Password required'"
      ></mat-icon>
      <input
        matInput
        type="password"
        [value]="password()"
        (input)="onPasswordInput($any($event.target).value)"
        [disabled]="isSubmitting() || disabled()"
        [placeholder]="placeholder()"
        autocomplete="current-password"
      />
    </mat-form-field>

    @if (showStoreOption()) {
      <div class="store-option">
        <mat-checkbox
          [checked]="storePassword()"
          (change)="onStoreChange($event.checked)"
          [disabled]="isSubmitting() || disabled()"
        ></mat-checkbox>
        <div class="store-content">
          <span class="store-label">Remember password</span>
          <span class="store-hint">
            <mat-icon svgIcon="shield"></mat-icon>
            Stored in system keychain
          </span>
        </div>
      </div>
    }
  </div>
</div>
