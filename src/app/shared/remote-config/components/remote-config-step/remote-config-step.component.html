<form [formGroup]="form" class="remote-form">
  <div class="basic-section">
    <mat-form-field appearance="outline">
      <mat-label>Remote Name</mat-label>
      <input matInput formControlName="name" id="remoteName" placeholder="e.g., my-cloud-storage" />
    </mat-form-field>

    <mat-form-field appearance="outline">
      <mat-label>Search Remote Type</mat-label>
      <input
        type="text"
        matInput
        [formControl]="remoteSearchCtrl"
        [matAutocomplete]="auto"
        placeholder="e.g., Google Drive"
      />
      <mat-autocomplete
        #auto="matAutocomplete"
        [displayWith]="displayRemote.bind(this)"
        (optionSelected)="onTypeSelected($event.option.value)"
      >
        @for (remote of filteredRemotes$ | async; track remote.value) {
          <mat-option [value]="remote.value">{{ remote.label }}</mat-option>
        }
        @if ((filteredRemotes$ | async)?.length === 0) {
          <mat-option disabled>No matching remote types</mat-option>
        }
      </mat-autocomplete>
    </mat-form-field>
  </div>

  <!-- Loading State -->
  @if (isLoading) {
    <div class="loading-container">
      <mat-spinner diameter="30"></mat-spinner>
      <span>Loading configuration options...</span>
    </div>
  }

  <!-- Configuration Toggles -->
  @if (remoteFields.length > 0) {
    <div class="config-toggles">
      <mat-slide-toggle (change)="toggleAdvancedOptions()" [checked]="showAdvancedOptions">
        Show Advanced Options
      </mat-slide-toggle>

      <mat-slide-toggle (change)="toggleInteractiveMode()" [checked]="useInteractiveMode">
        Use Interactive Configuration
      </mat-slide-toggle>
    </div>
  }

  <!-- Basic Configuration Fields -->
  @if (basicFields.length > 0) {
    <div class="basic-section">
      @for (field of basicFields; track field.Name) {
        <app-setting-control [option]="field" [formControlName]="field.Name"></app-setting-control>
      }
    </div>
  }

  <!-- Advanced Options Section -->
  @if (showAdvancedOptions && advancedFields.length > 0) {
    <div class="advanced-section">
      <h3 class="section-heading">
        Advanced Options
        <span>{{ advancedFields.length }}</span>
      </h3>

      @for (field of advancedFields; track field.Name) {
        <app-setting-control [option]="field" [formControlName]="field.Name"></app-setting-control>
      }
    </div>
  }
</form>
