<div class="remote-details">
  <div class="detail-header">
    <div class="header-content">
      <div class="remote-info-section">
        <div
          [ngClass]="{
            'icon-container': true,
            sync: isSyncType() && getOperationActiveState(),
            copy: selectedSyncOperation === 'copy' && getOperationActiveState(),
            move: selectedSyncOperation === 'move' && getOperationActiveState(),
            bisync: selectedSyncOperation === 'bisync' && getOperationActiveState(),
            mount: selectedRemote.mountState?.mounted,
          }"
        >
          <mat-icon
            [svgIcon]="iconService.getIconName(selectedRemote.remoteSpecs.type)"
            class="remote-type-icon"
          ></mat-icon>
        </div>
        <div class="remote-text-info">
          <h2 class="remote-name" matTooltip="{{ selectedRemote.remoteSpecs.name }}">
            {{ selectedRemote.remoteSpecs.name }}
          </h2>
          <span class="remote-type">{{ selectedRemote.remoteSpecs.type | titlecase }}</span>
        </div>
      </div>
    </div>
    <div class="header-divider"></div>
  </div>

  <!-- Main Content Area -->
  <div class="detail-content">
    @if (mainOperationType === 'sync') {
      <div class="sync-operation-wrapper">
        <!-- Operation Selection Buttons -->
        <div class="operation-buttons">
          @for (operation of syncOperations; track operation.type) {
            <button
              mat-flat-button
              [class]="
                'operation-button operation-' +
                operation.type +
                (selectedSyncOperation === operation.type ? ' active' : '') +
                ' ' +
                operation.cssClass
              "
              [style.--operation-color]="operation.cssClass"
              (click)="onSyncOperationChange(operation.type)"
              [matTooltip]="operation.description"
              matTooltipPosition="below"
            >
              <mat-icon [svgIcon]="operation.icon" class="operation-icon"></mat-icon>
              <span class="operation-label">{{ operation.label }}</span>
            </button>
          }
        </div>

        <div class="sync-operation-content">
          <mat-tab-group class="operation-tabs" animationDuration="300ms">
            <!-- Monitoring Tab -->
            <mat-tab>
              <ng-template mat-tab-label>
                <span>Monitoring</span>
              </ng-template>

              <div class="operation-monitor">
                <!-- Operation Control Panel -->
                <app-operation-control
                  [config]="getOperationControlConfig()"
                  (startJob)="
                    startJob.emit({ type: $event, remoteName: selectedRemote.remoteSpecs.name })
                  "
                  (stopJob)="
                    stopJob.emit({ type: $event, remoteName: selectedRemote.remoteSpecs.name })
                  "
                  (openPath)="triggerOpenInFiles($event)"
                  class="control-panel"
                >
                </app-operation-control>

                <!-- Human Readable Cron Expression -->
                @if (isCronEnabled()) {
                  <div class="cron-human-readable">
                    <mat-icon svgIcon="clock" class="cron-icon"></mat-icon>
                    <span>{{ getHumanReadableCron() }}</span>
                  </div>
                }

                <!-- Job Information Panel -->
                <app-job-info-panel
                  [config]="getJobInfoConfig()"
                  class="info-panel"
                ></app-job-info-panel>

                <!-- Statistics Panel -->
                <app-stats-panel [config]="getStatsConfig()" class="stats-panel"></app-stats-panel>

                <!-- Transfer Activity Panel -->
                <app-transfer-activity-panel
                  [config]="getTransferActivityConfig()"
                  class="activity-panel"
                ></app-transfer-activity-panel>

                <!-- Performance Charts Panel -->
                @if (shouldShowCharts()) {
                  <div class="performance-graphs">
                    <mat-card class="graph-card speed-chart">
                      <mat-card-header>
                        <div mat-card-avatar>
                          <mat-icon svgIcon="chart" class="chart-icon"></mat-icon>
                        </div>
                        <mat-card-title>Transfer Speed</mat-card-title>
                      </mat-card-header>
                      <mat-card-content>
                        <div class="chart-container">
                          <canvas #speedChart></canvas>
                        </div>
                      </mat-card-content>
                    </mat-card>

                    <mat-card class="graph-card progress-chart">
                      <mat-card-header>
                        <div mat-card-avatar>
                          <mat-icon svgIcon="chart" class="chart-icon"></mat-icon>
                        </div>
                        <mat-card-title>Transfer Progress</mat-card-title>
                      </mat-card-header>
                      <mat-card-content>
                        <div class="chart-container">
                          <canvas #progressChart></canvas>
                        </div>
                      </mat-card-content>
                    </mat-card>
                  </div>
                }
              </div>
            </mat-tab>

            <!-- Configuration Tab -->
            <mat-tab>
              <ng-template mat-tab-label>
                <span>Configuration</span>
              </ng-template>

              <div class="configuration-content">
                <!-- Operation-Specific Warnings -->
                @switch (selectedSyncOperation) {
                  @case ('move') {
                    <mat-card class="detail-panel">
                      <mat-card-header class="panel-header">
                        <mat-card-title class="panel-title-content">
                          <mat-icon svgIcon="warning" class="warn"></mat-icon>Move Operation Warning
                        </mat-card-title>
                      </mat-card-header>
                      <mat-card-content class="panel-content">
                        <p>
                          Files will be <strong>deleted</strong> from the source after successful
                          transfer to destination.
                        </p>
                        <p>Ensure you have backups before proceeding with move operations.</p>
                      </mat-card-content>
                    </mat-card>
                  }
                  @case ('bisync') {
                    <mat-card class="detail-panel">
                      <mat-card-header class="panel-header">
                        <mat-card-title class="panel-title-content">
                          <mat-icon svgIcon="info" class="panel-icon"></mat-icon>BiSync Information
                        </mat-card-title>
                      </mat-card-header>
                      <mat-card-content class="panel-content">
                        <p>Bidirectional synchronization keeps both locations synchronized.</p>
                        <p>Changes made to either location will be reflected in the other.</p>
                        <p>First run may take longer as it establishes the sync baseline.</p>
                      </mat-card-content>
                    </mat-card>
                  }
                }
                <div class="settings-layout">
                  @if (operationSettingsSections.length) {
                    <section class="settings-group operation-settings">
                      <header class="group-header">
                        <h3 class="group-title">{{ operationSettingsHeading }}</h3>
                        <p class="group-description">{{ operationSettingsDescription }}</p>
                      </header>
                      <div class="group-panels">
                        @for (section of operationSettingsSections; track section.key) {
                          <app-settings-panel
                            [config]="getSettingsPanelConfig(section)"
                            (editSettings)="onEditSettings($event)"
                            class="settings-section"
                          ></app-settings-panel>
                        }
                      </div>
                    </section>
                  }

                  @if (sharedSettingsSections.length) {
                    <section class="settings-group shared-settings">
                      <header class="group-header">
                        <h3 class="group-title">{{ sharedSettingsHeading }}</h3>
                        <p class="group-description">{{ sharedSettingsDescription }}</p>
                      </header>
                      <div class="group-panels">
                        @for (section of sharedSettingsSections; track section.key) {
                          <app-settings-panel
                            [config]="getSettingsPanelConfig(section)"
                            (editSettings)="onEditSettings($event)"
                            class="settings-section"
                          ></app-settings-panel>
                        }
                      </div>
                    </section>
                  }
                </div>
              </div>
            </mat-tab>
          </mat-tab-group>
        </div>
      </div>
    }

    <!-- MOUNT Operations -->
    @else {
      <div class="mount-operation-wrapper">
        <div class="configuration-content">
          <!-- Mount Control Panel -->
          <app-operation-control
            [config]="getMountControlConfig()"
            (startJob)="
              startJob.emit({
                type: 'mount',
                remoteName: selectedRemote.remoteSpecs.name,
              })
            "
            (stopJob)="
              stopJob.emit({
                type: 'mount',
                remoteName: selectedRemote.remoteSpecs.name,
              })
            "
            (openPath)="triggerOpenInFiles($event)"
            class="mount-control-panel"
          ></app-operation-control>

          <mat-divider></mat-divider>

          <div class="settings-layout">
            @if (operationSettingsSections.length) {
              <section class="settings-group operation-settings">
                <header class="group-header">
                  <h3 class="group-title">{{ operationSettingsHeading }}</h3>
                  <p class="group-description">{{ operationSettingsDescription }}</p>
                </header>
                <div class="group-panels">
                  @for (section of operationSettingsSections; track section.key) {
                    <app-settings-panel
                      [config]="getSettingsPanelConfig(section)"
                      (editSettings)="onEditSettings($event)"
                      class="mount-settings-section"
                    ></app-settings-panel>
                  }
                </div>
              </section>
            }

            @if (sharedSettingsSections.length) {
              <section class="settings-group shared-settings">
                <header class="group-header">
                  <h3 class="group-title">{{ sharedSettingsHeading }}</h3>
                  <p class="group-description">{{ sharedSettingsDescription }}</p>
                </header>
                <div class="group-panels">
                  @for (section of sharedSettingsSections; track section.key) {
                    <app-settings-panel
                      [config]="getSettingsPanelConfig(section)"
                      (editSettings)="onEditSettings($event)"
                      class="mount-settings-section"
                    ></app-settings-panel>
                  }
                </div>
              </section>
            }
          </div>
        </div>
      </div>
    }
  </div>
</div>
