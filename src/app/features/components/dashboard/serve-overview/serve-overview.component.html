<!-- serve-overview.component.html -->
<div class="serve-overview" @fadeInOut>
  <!-- Header Section -->
  <app-overview-header mode="serve"></app-overview-header>

  <div class="overview-content">
    <!-- Status Overview Panel -->
    <app-status-overview-panel
      mode="serve"
      [totalCount]="remotes.length"
      [activeCount]="activeCount"
      [inactiveCount]="inactiveCount"
    >
    </app-status-overview-panel>

    <!-- Active Serves Panel: show individual serve cards because a remote can have multiple serves -->
    @if (activeCount > 0) {
      <mat-card class="remotes-panel active-remotes-panel">
        <mat-card-header class="remotes-header">
          <mat-card-title class="panel-title-content">
            <mat-icon [svgIcon]="activeIcon" class="active-icon"></mat-icon>
            <span>{{ getActiveTitle() }}</span>
            <span class="remote-count">{{ runningServes.length }}</span>
          </mat-card-title>
        </mat-card-header>

        <mat-card-content class="remotes-content">
          <div class="remotes-grid">
            @for (serve of runningServes; track serve.id) {
              <app-serve-card
                [serve]="serve"
                [showRemoteName]="true"
                (stopServe)="
                  stopJob.emit({
                    type: 'serve',
                    serveId: $event.id,
                    remoteName: $event.params.fs.split(':')[0],
                  })
                "
                (copyToClipboard)="handleCopyToClipboard($event)"
                (cardClick)="handleServeCardClick($event)"
              >
              </app-serve-card>
            }
          </div>
        </mat-card-content>
      </mat-card>
    }

    <!-- Available Remotes Panel -->
    @if (inactiveCount > 0) {
      <app-remotes-panel
        [title]="getInactiveTitle()"
        [icon]="'circle-xmark'"
        [remotes]="inactiveRemotes"
        mode="serve"
        [actionInProgress]="actionInProgress"
        [primaryActionLabel]="primaryActionLabel"
        [activeIcon]="activeIcon"
        (remoteSelected)="selectRemote($event)"
        (startJob)="triggerStartServe($event.remoteName)"
      >
      </app-remotes-panel>
    }
  </div>
</div>
