<div class="modal-container">
  <!-- Header -->
  <div class="modal-header" data-tauri-drag-region>
    <button
      (click)="toggleSearch()"
      matIconButton
      [attr.aria-label]="
        searchVisible ? ('shortcuts.hideSearch' | translate) : ('shortcuts.showSearch' | translate)
      "
      [attr.aria-expanded]="searchVisible"
    >
      <mat-icon svgIcon="search"></mat-icon>
    </button>
    <p>{{ 'shortcuts.title' | translate }}</p>
    <button matIconButton (click)="close()" [attr.aria-label]="'shortcuts.ariaClose' | translate">
      <mat-icon svgIcon="circle-xmark"></mat-icon>
    </button>
  </div>

  <!-- Search Box with Animation -->
  <app-search-container
    [visible]="searchVisible"
    [searchText]="searchText"
    (searchTextChange)="onSearchTextChange($event)"
    [placeholder]="'shortcuts.searchPlaceholder' | translate"
    [ariaLabel]="'shortcuts.ariaSearch' | translate"
  >
  </app-search-container>

  <!-- Shortcuts Table -->
  <div class="modal-content">
    <table
      mat-table
      [dataSource]="filteredShortcuts"
      class="shortcut-table"
      role="table"
      [attr.aria-label]="'shortcuts.ariaList' | translate"
    >
      <ng-container matColumnDef="keys">
        <td mat-cell *matCellDef="let shortcut" class="shortcut-key" role="gridcell">
          @for (key of shortcut.keys.split('+'); track key; let isLast = $last) {
            <span class="key" [attr.data-key]="key.trim()">{{ key.trim() }}</span>
            @if (!isLast) {
              <span class="key-separator" aria-hidden="true">+</span>
            }
          }
        </td>
      </ng-container>

      <ng-container matColumnDef="description">
        <td mat-cell *matCellDef="let shortcut" class="shortcut-desc" role="gridcell">
          {{ shortcut.description | translate }}
        </td>
      </ng-container>

      <tr mat-row *matRowDef="let row; columns: ['keys', 'description']" role="row"></tr>
    </table>

    <!-- Empty state when no shortcuts match search -->
    @if (filteredShortcuts.length === 0 && searchText) {
      <div class="empty-state">
        <mat-icon svgIcon="search"></mat-icon>
        <span>{{ 'shortcuts.noResults.title' | translate }}</span>
        <p>{{ 'shortcuts.noResults.description' | translate }}</p>
        <button matButton="filled" class="accent" (click)="clearSearch()">
          {{ 'shortcuts.noResults.action' | translate }}
        </button>
      </div>
    }
  </div>
</div>
