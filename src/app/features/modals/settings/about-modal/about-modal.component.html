<div class="about-modal">
  <div class="modal-header" data-tauri-drag-region [class.scrolled]="scrolled()">
    <button>
      <mat-icon></mat-icon>
    </button>
    <p style="opacity: 0">{{ 'modals.about.title' | translate }}</p>
    <button mat-icon-button (click)="close()" [aria-label]="'common.close' | translate">
      <mat-icon svgIcon="circle-xmark"></mat-icon>
    </button>
  </div>

  <div class="modal-content" #content (scroll)="onScroll(content)">
    <img
      src="assets/rclone.svg"
      alt="Rclone Logo"
      class="app-icon"
      (click)="onLogoClick()"
      (keydown.enter)="onLogoClick()"
      (keydown.space)="onLogoClick()"
      tabindex="0"
      role="button"
      style="cursor: pointer"
      [matTooltip]="logoClickCount >= 3 ? ('modals.about.keepClicking' | translate) : ''"
    />
    <h2 class="app-name">RClone Manager</h2>
    <p class="app-team">
      Zarestia
      <mat-icon svgIcon="wind"></mat-icon>
    </p>
    <div class="version-info">
      <button class="version-badge" (click)="copyToClipboard(rCloneManagerVersion)">
        {{ rCloneManagerVersion }}
      </button>
      @if (buildType()) {
        <span
          class="platform-badge"
          [class]="buildType()"
          [matTooltip]="getChannelLabel(buildType()) | translate"
        >
          <mat-icon svgIcon="package"></mat-icon>
          {{ getChannelLabel(buildType()) | translate }}
        </span>
      }
    </div>

    <div class="about-list">
      @for (item of navItems; track item.page) {
        <button
          matButton
          class="about-item"
          (click)="navigateTo(item.page)"
          [matBadge]="item.badgeSignal ? (item.badgeSignal().available ? '!' : null) : null"
        >
          <span>{{ item.label | translate }}</span>
          <mat-icon [svgIcon]="item.icon"></mat-icon>
        </button>
      }

      @if (!updatesDisabled()) {
        <button
          matButton
          class="about-item"
          (click)="navigateTo('Updates')"
          [matBadge]="appUpdateAvailable() || appRestartRequired() ? '!' : null"
        >
          <span>{{ 'modals.about.updates' | translate }}</span>
          <mat-icon svgIcon="chevron-right"></mat-icon>
        </button>
      }

      <div class="stacked-buttons">
        @for (item of bottomNavItems; track item.page; let last = $last) {
          <button matButton class="about-item" (click)="navigateTo(item.page)">
            <span>{{ item.label | translate }}</span>
            <mat-icon [svgIcon]="item.icon"></mat-icon>
          </button>
          @if (!last) {
            <mat-divider></mat-divider>
          }
        }
      </div>
    </div>
  </div>

  @for (overlay of overlayStack(); track overlay.id; let i = $index) {
    <div
      class="overlay"
      [class.whats-new-overlay]="
        overlay.id === 'whats-new-app' || overlay.id === 'whats-new-rclone'
      "
      [class.debug-overlay]="overlay.id === 'debug' || overlay.id === 'memory'"
      [style.z-index]="10 + i"
      animate.enter="slide-overlay-enter"
      animate.leave="slide-overlay-leave"
    >
      <div class="modal-header" data-tauri-drag-region>
        <button mat-icon-button (click)="goBack()">
          <mat-icon svgIcon="chevron-left"></mat-icon>
        </button>
        <p>
          {{ getPageTitle(overlay.id) }}
        </p>
        <button mat-icon-button (click)="close()">
          <mat-icon svgIcon="circle-xmark"></mat-icon>
        </button>
      </div>

      @switch (overlay.id) {
        @case ('details') {
          <div class="modal-content">
            <div class="stacked-buttons">
              <a
                matButton
                class="about-item"
                href="https://github.com/Zarestia-Dev/rclone-manager"
                target="_blank"
                rel="noopener noreferrer"
              >
                <span>{{ 'modals.about.website' | translate }}</span>
                <mat-icon svgIcon="open-link"></mat-icon>
              </a>
              <mat-divider></mat-divider>
              <a
                matButton
                class="about-item"
                href="https://github.com/Zarestia-Dev/rclone-manager/issues"
                target="_blank"
                rel="noopener noreferrer"
              >
                <span>{{ 'modals.about.reportIssues' | translate }}</span>
                <mat-icon svgIcon="open-link"></mat-icon>
              </a>
            </div>

            <div class="about-list">
              <a
                matButton
                class="about-item"
                href="https://rclone.org"
                target="_blank"
                rel="noopener noreferrer"
              >
                <span>{{ 'modals.about.rcloneWebsite' | translate }}</span>
                <mat-icon svgIcon="open-link"></mat-icon>
              </a>
            </div>
          </div>
        }
        @case ('updates') {
          <div class="modal-content updates-page">
            <div class="current-version-card">
              <div class="version-info">
                <span class="version-label">{{ 'modals.about.currentVersion' | translate }}</span>
                <span class="version-number">{{ rCloneManagerVersion }}</span>
              </div>
            </div>

            @if (appRestartRequired()) {
              <div class="update-card restart-required">
                <div class="update-header">
                  <mat-icon svgIcon="reset-wrench"></mat-icon>
                  <div class="update-title">
                    <h4>{{ 'modals.about.restartRequired' | translate }}</h4>
                    <p class="restart-description">
                      {{ 'modals.about.restartDescription' | translate }}
                    </p>
                  </div>
                </div>
                <div class="update-buttons">
                  <button mat-flat-button class="accent" (click)="relaunchApp()">
                    <span>{{ 'modals.about.restartNow' | translate }}</span>
                  </button>
                </div>
              </div>
            } @else if (appUpdateAvailable()) {
              <div class="update-card available">
                <div class="update-header">
                  <mat-icon svgIcon="circle-up"></mat-icon>
                  <div class="update-title">
                    <h4>{{ 'modals.about.updateAvailable' | translate }}</h4>
                    <span class="new-version">
                      {{ 'modals.about.version' | translate }}
                      {{ appUpdateAvailable()?.version }}
                      @if (appUpdateReleaseChannel()) {
                        <span class="release-badge badge-{{ appUpdateReleaseChannel() }}">
                          {{ getChannelLabel(appUpdateReleaseChannel()) | translate }}
                        </span>
                      }
                    </span>
                  </div>
                </div>

                @if (appUpdateAvailable()?.releaseNotes) {
                  <button mat-stroked-button class="whats-new-button" (click)="showWhatsNew('app')">
                    <mat-icon svgIcon="file-lines"></mat-icon>
                    {{ 'modals.about.whatsNew' | translate }}
                  </button>
                }

                @if (appDownloadInProgress()) {
                  <div class="download-progress">
                    <mat-progress-bar
                      mode="determinate"
                      [value]="appDownloadPercentage()"
                    ></mat-progress-bar>
                    <div class="progress-info">
                      <span>{{ 'modals.about.downloading' | translate }}</span>
                      <span>
                        {{ appDownloadProgress() | formatFileSize }} /
                        {{ appDownloadTotal() | formatFileSize }}
                      </span>
                    </div>
                  </div>
                }

                <div class="update-buttons">
                  <button
                    mat-flat-button
                    (click)="installUpdate()"
                    [disabled]="appUpdateInProgress() || appDownloadInProgress()"
                  >
                    @if (appUpdateInProgress() || appDownloadInProgress()) {
                      <mat-spinner diameter="16"></mat-spinner>
                      {{
                        appDownloadInProgress()
                          ? ('modals.about.downloading' | translate)
                          : ('modals.about.installing' | translate)
                      }}
                    } @else {
                      {{ 'modals.about.installUpdate' | translate }}
                    }
                  </button>
                  <button
                    mat-stroked-button
                    (click)="skipUpdate()"
                    [disabled]="appDownloadInProgress()"
                  >
                    {{ 'modals.about.skipVersion' | translate }}
                  </button>
                </div>
              </div>
            } @else {
              <!-- Up to Date Card -->
              <ng-container
                *ngTemplateOutlet="upToDateCard; context: { $implicit: 'modals.about.upToDate' }"
              ></ng-container>
            }

            <button
              mat-stroked-button
              (click)="checkForUpdates()"
              [disabled]="checkingForUpdates || appDownloadInProgress() || appRestartRequired()"
              class="check-button"
            >
              @if (checkingForUpdates) {
                <mat-spinner diameter="16"></mat-spinner>
                {{ 'modals.about.checking' | translate }}
              } @else {
                {{ 'modals.about.checkUpdates' | translate }}
              }
            </button>

            <div class="settings-section">
              <h4>{{ 'modals.about.updateSettings' | translate }}</h4>
              <ng-container
                *ngTemplateOutlet="
                  settingsControls;
                  context: {
                    autoCheck: appAutoCheckUpdates(),
                    channel: appUpdateChannel(),
                    channels: channels,
                    disabled: appDownloadInProgress(),
                  }
                "
              ></ng-container>
            </div>

            @if (appSkippedVersions().length > 0) {
              <div class="skipped-section">
                <h4>{{ 'modals.about.skippedUpdates' | translate }}</h4>
                <ng-container
                  *ngTemplateOutlet="skippedList; context: { versions: appSkippedVersions() }"
                ></ng-container>
              </div>
            }
          </div>
        }
        @case ('about-rclone') {
          <div class="modal-content updates-page">
            <div class="rclone-info">
              <div class="rclone-header">
                <h4>{{ 'modals.about.rcloneInfo' | translate }}</h4>
              </div>

              @if (loadingRclone()) {
                <div class="loading">
                  <mat-spinner diameter="24"></mat-spinner>
                  <span>{{ 'modals.about.loadingRclone' | translate }}</span>
                </div>
              }

              @if (rcloneError()) {
                <div class="error">
                  <mat-icon svgIcon="circle-exclamation"></mat-icon>
                  <span>{{ rcloneError() }}</span>
                </div>
              }

              @if (rcloneInfo() && !loadingRclone()) {
                <div class="rclone-details">
                  <div class="detail-row">
                    <span class="detail-label">{{ 'modals.about.version' | translate }}:</span>
                    <span class="detail-value">{{ rcloneInfo()?.version }}</span>
                  </div>
                  <div class="detail-row">
                    <span class="detail-label">{{ 'modals.about.os' | translate }}:</span>
                    <span class="detail-value"
                      >{{ rcloneInfo()?.os }} ({{ rcloneInfo()?.arch }})</span
                    >
                  </div>
                  @if (rcloneInfo()?.pid) {
                    <div class="detail-row">
                      <span class="detail-label">{{ 'modals.about.pid' | translate }}:</span>
                      <span class="detail-value">{{ rcloneInfo()?.pid }}</span>
                      <button
                        matIconButton
                        [matTooltip]="
                          backendService.activeBackend() === 'Local'
                            ? ('modals.about.killProcess' | translate)
                            : ('modals.about.quitRclone' | translate)
                        "
                        matTooltipPosition="right"
                        (click)="quitRcloneEngine()"
                        class="kill-button"
                      >
                        <mat-icon
                          [svgIcon]="
                            backendService.activeBackend() === 'Local' ? 'skull' : 'power-off'
                          "
                          class="orange"
                        ></mat-icon>
                      </button>
                    </div>
                  }
                  <div class="detail-row">
                    <span class="detail-label">{{ 'modals.about.goVersion' | translate }}:</span>
                    <span class="detail-value">{{ rcloneInfo()?.goVersion }}</span>
                  </div>

                  @if (rcloneInfo()?.isBeta || rcloneInfo()?.isGit) {
                    <div class="detail-row warning">
                      <mat-icon svgIcon="warning"></mat-icon>
                      <span>{{
                        rcloneInfo()?.isBeta
                          ? ('modals.about.betaVersion' | translate)
                          : ('modals.about.devBuild' | translate)
                      }}</span>
                    </div>
                  }

                  @if (memoryStats()) {
                    <div class="detail-row">
                      <span class="detail-label">{{ 'modals.about.memory' | translate }}:</span>
                      <span class="detail-value">{{ memoryStats()!.Alloc | formatFileSize }}</span>
                      <button
                        mat-icon-button
                        class="action-button"
                        (click)="showMemoryOverlay()"
                        [matTooltip]="'modals.about.viewMemoryStats' | translate"
                      >
                        <mat-icon svgIcon="chart"></mat-icon>
                      </button>
                    </div>
                  }
                  <div class="detail-row">
                    <span class="detail-label">{{ 'modals.about.backendCache' | translate }}:</span>
                    <span class="detail-value"
                      >{{ fsCacheEntries() }} {{ 'modals.about.entries' | translate }}</span
                    >
                    <button
                      mat-icon-button
                      class="action-button"
                      (click)="clearFsCache()"
                      [disabled]="clearingFsCache()"
                      [matTooltip]="'modals.about.clear' | translate"
                    >
                      @if (clearingFsCache()) {
                        <mat-spinner diameter="16"></mat-spinner>
                      } @else {
                        <mat-icon svgIcon="trash" class="warn"></mat-icon>
                      }
                    </button>
                  </div>
                </div>
              }
            </div>

            @if (isLocalBackend()) {
              @if (rcloneUpdateStatus().updateInfo?.update_available) {
                <div class="update-card available">
                  <div class="update-header">
                    <mat-icon svgIcon="circle-up"></mat-icon>
                    <div class="update-title">
                      <h4>{{ 'modals.about.rcloneUpdateAvailable' | translate }}</h4>
                      <span class="new-version">
                        {{ 'modals.about.version' | translate }}
                        {{
                          rcloneUpdateStatus().updateInfo?.latest_version_clean ||
                            rcloneUpdateStatus().updateInfo?.latest_version
                        }}
                        <span class="release-badge badge-{{ rcloneUpdateChannel() }}">
                          {{ getChannelLabel(rcloneUpdateChannel()) | translate }}
                        </span>
                      </span>
                    </div>
                  </div>

                  @if (rcloneUpdateStatus().updateInfo?.release_notes) {
                    <button
                      mat-stroked-button
                      class="whats-new-button"
                      (click)="showWhatsNew('rclone')"
                    >
                      <mat-icon svgIcon="file-lines"></mat-icon>
                      {{ 'modals.about.whatsNewRclone' | translate }}
                    </button>
                  }

                  <div class="update-buttons">
                    <button
                      matButton="filled"
                      (click)="installRcloneUpdate()"
                      [disabled]="rcloneUpdateStatus().updating"
                    >
                      @if (rcloneUpdateStatus().updating) {
                        <mat-spinner diameter="16"></mat-spinner>
                        {{
                          rcloneUpdateStatus().updating
                            ? ('modals.about.updating' | translate)
                            : ('modals.about.updateRclone' | translate)
                        }}
                      } @else {
                        {{ 'modals.about.updateRclone' | translate }}
                      }
                    </button>
                    <button mat-button (click)="skipRcloneUpdate()">
                      {{ 'modals.about.skipVersion' | translate }}
                    </button>
                  </div>
                </div>
              } @else {
                <!-- Up to Date Card -->
                <ng-container
                  *ngTemplateOutlet="
                    upToDateCard;
                    context: { $implicit: 'modals.about.rcloneUpToDate' }
                  "
                ></ng-container>
              }

              <button
                matButton="outlined"
                (click)="checkForRcloneUpdates()"
                [disabled]="rcloneUpdateStatus().checking"
                class="check-button"
              >
                @if (rcloneUpdateStatus().checking) {
                  <mat-spinner diameter="16"></mat-spinner>
                  {{ 'modals.about.checking' | translate }}
                } @else {
                  {{ 'modals.about.checkRcloneUpdates' | translate }}
                }
              </button>

              <div class="settings-section">
                <h4>{{ 'modals.about.rcloneUpdateSettings' | translate }}</h4>
                <ng-container
                  *ngTemplateOutlet="
                    settingsControls;
                    context: {
                      autoCheck: rcloneAutoCheck(),
                      channel: rcloneUpdateChannel(),
                      channels: channels,
                      isRclone: true,
                    }
                  "
                ></ng-container>
              </div>

              @if (rcloneSkippedVersions().length > 0) {
                <div class="skipped-section">
                  <h4>{{ 'modals.about.skippedRcloneUpdates' | translate }}</h4>
                  <ng-container
                    *ngTemplateOutlet="
                      skippedList;
                      context: { versions: rcloneSkippedVersions(), isRclone: true }
                    "
                  ></ng-container>
                </div>
              }
            } @else {
              <!-- Remote Backend Info Card -->
              <div class="update-card not-supported">
                <mat-icon svgIcon="cloud"></mat-icon>
                <div class="status-text">
                  <h4>{{ 'modals.about.remoteBackend' | translate }}</h4>
                  <p>
                    {{ 'modals.about.remoteUpdateInfo' | translate }}
                    <a
                      href="https://github.com/rclone/rclone/issues/9120"
                      target="_blank"
                      rel="noopener noreferrer"
                    >
                      #9120
                    </a>
                  </p>
                </div>
              </div>
            }
          </div>
        }
        @case ('credits') {
          <div class="modal-content">
            <h4>{{ 'modals.about.devTeam' | translate }}</h4>
            <div class="about-item">
              <mat-icon svgIcon="terminal"></mat-icon>
              <span>Hakan İSMAİL - {{ 'modals.about.leadDeveloper' | translate }}</span>
            </div>

            <h4>{{ 'modals.about.acknowledgments' | translate }}</h4>
            <p>
              {{ 'modals.about.ackText' | translate }}
            </p>
          </div>
        }
        @case ('legal') {
          <div class="modal-content">
            <h4>{{ 'modals.about.license' | translate }}</h4>
            <p>
              {{ 'modals.about.licenseText1' | translate }}
              <a
                href="https://www.gnu.org/licenses/gpl-3.0.html"
                target="_blank"
                rel="noopener noreferrer"
              >
                GNU General Public License v3
              </a>
              {{ 'modals.about.orLater' | translate }}
            </p>

            <p>
              {{ 'modals.about.licenseText2' | translate }}
            </p>

            <h4>{{ 'modals.about.thirdParty' | translate }}</h4>
            <p>
              {{ 'modals.about.thirdPartyText' | translate }}
            </p>
          </div>
        }
        @case ('whats-new-app') {
          <div class="modal-content whats-new-content">
            @if (appUpdateAvailable()) {
              <div class="release-header">
                <div class="release-version">
                  <h2>Version {{ appUpdateAvailable()?.version }}</h2>
                  @if (appUpdateAvailable()?.releaseDate) {
                    <span class="release-date">
                      {{ formatReleaseDate(appUpdateAvailable()!.releaseDate!) }}
                    </span>
                  }
                </div>
                @if (appUpdateAvailable()?.releaseUrl) {
                  <a
                    mat-stroked-button
                    [href]="appUpdateAvailable()!.releaseUrl"
                    target="_blank"
                    rel="noopener noreferrer"
                    class="whats-new-button"
                  >
                    <mat-icon svgIcon="open-link"></mat-icon>
                    <span style="text-wrap: nowrap">{{
                      'modals.about.viewOnGithub' | translate
                    }}</span>
                  </a>
                }
              </div>

              <div
                class="release-notes markdown-body"
                [innerHTML]="getFormattedReleaseNotes(appUpdateAvailable()!.releaseNotes)"
              ></div>
            }
          </div>
        }
        @case ('whats-new-rclone') {
          <div class="modal-content whats-new-content">
            @if (rcloneUpdateStatus().updateInfo) {
              <div class="release-header">
                <div class="release-version">
                  <h2>
                    Rclone
                    {{
                      rcloneUpdateStatus().updateInfo?.latest_version_clean ||
                        rcloneUpdateStatus().updateInfo?.latest_version
                    }}
                  </h2>
                  @if (rcloneUpdateStatus().updateInfo?.release_date) {
                    <span class="release-date">
                      {{ formatReleaseDate(rcloneUpdateStatus().updateInfo!.release_date!) }}
                    </span>
                  }
                </div>
                @if (rcloneUpdateStatus().updateInfo?.release_url) {
                  <a
                    mat-stroked-button
                    [href]="rcloneUpdateStatus().updateInfo!.release_url"
                    target="_blank"
                    rel="noopener noreferrer"
                    class="whats-new-button"
                  >
                    <mat-icon svgIcon="open-link"></mat-icon>
                    {{ 'modals.about.viewOnGithub' | translate }}
                  </a>
                }
              </div>

              <div
                class="release-notes markdown-body"
                [innerHTML]="
                  getFormattedReleaseNotes(rcloneUpdateStatus().updateInfo?.release_notes)
                "
              ></div>
            }
          </div>
        }
        @case ('debug') {
          <div class="modal-content debug-content">
            @if (debugInfo()) {
              <div class="debug-section">
                <h4>{{ 'modals.about.systemInfo' | translate }}</h4>
                <div class="debug-info-grid">
                  <div class="debug-row">
                    <span class="label">{{ 'modals.about.version' | translate }}:</span>
                    <span class="value">{{ debugInfo()!.appVersion }}</span>
                  </div>
                  <div class="debug-row">
                    <span class="label">{{ 'modals.about.mode' | translate }}:</span>
                    <span class="value">{{ debugInfo()!.mode }}</span>
                  </div>
                  <div class="debug-row">
                    <span class="label">{{ 'modals.about.platform' | translate }}:</span>
                    <span class="value">{{ debugInfo()!.platform }} ({{ debugInfo()!.arch }})</span>
                  </div>
                </div>
              </div>

              <div class="debug-section">
                <h4>{{ 'modals.about.folders' | translate }}</h4>
                <div class="folder-buttons">
                  <button matButton class="about-item" (click)="openFolder('logs')">
                    <span>{{ 'modals.about.logsFolder' | translate }}</span>
                    <mat-icon svgIcon="open-link"></mat-icon>
                  </button>
                  <button matButton class="about-item" (click)="openFolder('config')">
                    <span>{{ 'modals.about.configFolder' | translate }}</span>
                    <mat-icon svgIcon="open-link"></mat-icon>
                  </button>
                  <button matButton class="about-item" (click)="openFolder('cache')">
                    <span>{{ 'modals.about.cacheFolder' | translate }}</span>
                    <mat-icon svgIcon="open-link"></mat-icon>
                  </button>
                </div>
              </div>

              <div class="debug-section">
                <h4>{{ 'modals.about.developerTools' | translate }}</h4>
                <div class="debug-actions">
                  <button matButton="filled" class="primary" (click)="openDevTools()">
                    <mat-icon svgIcon="terminal"></mat-icon>
                    {{ 'modals.about.openDevTools' | translate }}
                  </button>
                  <button matButton="outlined" class="warn" (click)="relaunchApp()">
                    <mat-icon svgIcon="reset-wrench"></mat-icon>
                    {{ 'modals.about.restartApp' | translate }}
                  </button>
                </div>
              </div>
            } @else {
              <div class="loading">
                <mat-spinner diameter="24"></mat-spinner>
                <span>{{ 'common.loading' | translate }}</span>
              </div>
            }
          </div>
        }
        @case ('memory') {
          <div class="modal-content debug-content">
            @if (memoryStats()) {
              <div class="debug-section">
                <h4>{{ 'modals.about.generalMemory' | translate }}</h4>
                <div class="debug-info-grid">
                  <div class="debug-row">
                    <span class="label">{{ 'modals.about.memAlloc' | translate }}</span>
                    <span class="value">{{ memoryStats()!.Alloc | formatFileSize }}</span>
                  </div>
                  <div class="debug-row">
                    <span class="label">{{ 'modals.about.memTotalAlloc' | translate }}</span>
                    <span class="value">{{ memoryStats()!.TotalAlloc | formatFileSize }}</span>
                  </div>
                  <div class="debug-row">
                    <span class="label">{{ 'modals.about.memSys' | translate }}</span>
                    <span class="value">{{ memoryStats()!.Sys | formatFileSize }}</span>
                  </div>
                  <div class="debug-row">
                    <span class="label">{{ 'modals.about.memMallocs' | translate }}</span>
                    <span class="value">{{ memoryStats()!.Mallocs }}</span>
                  </div>
                  <div class="debug-row">
                    <span class="label">{{ 'modals.about.memFrees' | translate }}</span>
                    <span class="value">{{ memoryStats()!.Frees }}</span>
                  </div>
                </div>
              </div>

              <div class="debug-section">
                <h4>{{ 'modals.about.heapMemory' | translate }}</h4>
                <div class="debug-info-grid">
                  <div class="debug-row">
                    <span class="label">{{ 'modals.about.memHeapAlloc' | translate }}</span>
                    <span class="value">{{ memoryStats()!.HeapAlloc | formatFileSize }}</span>
                  </div>
                  <div class="debug-row">
                    <span class="label">{{ 'modals.about.memHeapSys' | translate }}</span>
                    <span class="value">{{ memoryStats()!.HeapSys | formatFileSize }}</span>
                  </div>
                  <div class="debug-row">
                    <span class="label">{{ 'modals.about.memHeapIdle' | translate }}</span>
                    <span class="value">{{ memoryStats()!.HeapIdle | formatFileSize }}</span>
                  </div>
                  <div class="debug-row">
                    <span class="label">{{ 'modals.about.memHeapInuse' | translate }}</span>
                    <span class="value">{{ memoryStats()!.HeapInuse | formatFileSize }}</span>
                  </div>
                  <div class="debug-row">
                    <span class="label">{{ 'modals.about.memHeapReleased' | translate }}</span>
                    <span class="value">{{ memoryStats()!.HeapReleased | formatFileSize }}</span>
                  </div>
                  <div class="debug-row">
                    <span class="label">{{ 'modals.about.memHeapObjects' | translate }}</span>
                    <span class="value">{{ memoryStats()!.HeapObjects }}</span>
                  </div>
                </div>
              </div>

              <div class="debug-section">
                <h4>{{ 'modals.about.stackMemory' | translate }}</h4>
                <div class="debug-info-grid">
                  <div class="debug-row">
                    <span class="label">{{ 'modals.about.memStackInuse' | translate }}</span>
                    <span class="value">{{ memoryStats()!.StackInuse | formatFileSize }}</span>
                  </div>
                  <div class="debug-row">
                    <span class="label">{{ 'modals.about.memStackSys' | translate }}</span>
                    <span class="value">{{ memoryStats()!.StackSys | formatFileSize }}</span>
                  </div>
                </div>
              </div>

              <div class="debug-section">
                <h4>{{ 'modals.about.gc' | translate }}</h4>
                <div class="action-row" style="margin-top: var(--space-md)">
                  <button mat-flat-button (click)="runGarbageCollector()" [disabled]="runningGc()">
                    @if (runningGc()) {
                      <mat-spinner diameter="16"></mat-spinner>
                      {{ 'modals.about.runningGc' | translate }}
                    } @else {
                      <span class="content-wrapper">
                        <mat-icon svgIcon="broom"></mat-icon>
                        {{ 'modals.about.runGc' | translate }}
                      </span>
                    }
                  </button>
                </div>
              </div>
            } @else {
              <div class="loading">
                <mat-spinner diameter="24"></mat-spinner>
                <span>{{ 'common.loading' | translate }}</span>
              </div>
            }
          </div>
        }
      }
    </div>
  }
</div>

<!-- Up To Date template -->
<ng-template #upToDateCard let-title>
  <div class="update-card up-to-date">
    <mat-icon svgIcon="circle-check"></mat-icon>
    <div class="status-text">
      <h4>{{ title | translate }}</h4>
      <p>{{ 'modals.about.latestVersionMsg' | translate }}</p>
    </div>
  </div>
</ng-template>

<!-- Settings Controls Template -->
<ng-template
  #settingsControls
  let-autoCheck="autoCheck"
  let-channel="channel"
  let-channels="channels"
  let-disabled="disabled"
  let-isRclone="isRclone"
>
  <div class="settings-card">
    <div class="setting-group">
      <div class="setting-header">
        <span class="setting-title">{{ 'modals.about.autoCheck' | translate }}</span>
      </div>
      <div class="setting-control">
        <mat-slide-toggle
          [checked]="autoCheck"
          (change)="isRclone ? toggleRcloneAutoCheck() : toggleAutoCheck()"
          [disabled]="disabled"
        >
        </mat-slide-toggle>
      </div>
    </div>

    <mat-divider></mat-divider>

    <div class="setting-group">
      <div class="setting-header">
        <span class="setting-title">{{ 'modals.about.releaseChannel' | translate }}</span>
      </div>
      <div class="setting-control">
        <mat-form-field appearance="fill">
          <mat-select
            [value]="channel"
            (selectionChange)="
              isRclone ? changeRcloneChannel($event.value) : changeChannel($event.value)
            "
            [disabled]="disabled"
          >
            @for (ch of channels; track ch.value) {
              <mat-option
                [value]="ch.value"
                [matTooltip]="ch.description | translate"
                matTooltipPosition="left"
              >
                <div class="channel-option">
                  <span class="channel-name">{{ ch.label | translate }}</span>
                </div>
              </mat-option>
            }
          </mat-select>
        </mat-form-field>
      </div>
    </div>
  </div>
</ng-template>

<!-- Skipped List Template -->
<ng-template #skippedList let-versions="versions" let-isRclone="isRclone">
  <div class="skipped-list">
    @for (version of versions; track version) {
      <div class="skipped-item">
        <span class="version">{{ version }}</span>
        <button
          mat-icon-button
          (click)="isRclone ? unskipRcloneVersion(version) : unskipVersion(version)"
          [matTooltip]="'modals.about.restoreUpdate' | translate"
          class="restore-button"
        >
          <mat-icon svgIcon="rotate-right"></mat-icon>
        </button>
      </div>
    }
  </div>
</ng-template>
