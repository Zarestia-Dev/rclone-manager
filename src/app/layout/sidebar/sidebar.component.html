<div class="sidebar">
  <!-- Header Section -->
  <div
    class="sidebar-header"
    (click)="toggleSearch()"
    [matTooltip]="'sidebar.toggleSearch' | translate"
    [attr.aria-label]="'sidebar.toggleSearch' | translate"
    matTooltipShowDelay="500"
    role="button"
    tabindex="0"
  >
    <h3>
      <mat-icon svgIcon="server"></mat-icon>
      {{ 'sidebar.remotes' | translate }}
    </h3>
  </div>

  <!-- Search Container -->
  <app-search-container
    [visible]="searchVisible()"
    [searchText]="searchTerm()"
    (searchTextChange)="onSearchTextChange($event)"
    [placeholder]="'sidebar.searchPlaceholder' | translate"
    [ariaLabel]="'sidebar.searchAriaLabel' | translate"
  >
  </app-search-container>

  <!-- Scrollable Content Area -->
  <div class="content-area">
    <!-- Remote List -->
    @if (filteredRemotes().length > 0) {
      <ul>
        @for (remote of filteredRemotes(); track remote.remoteSpecs.name) {
          <mat-card
            class="remote-card"
            (click)="selectRemote(remote)"
            [class.selected]="selectedRemote()?.remoteSpecs?.name === remote.remoteSpecs.name"
          >
            <mat-card-content class="card-content">
              <!-- Remote Name with Status Indicators -->
              <div class="remote-header">
                <h4 matTooltipShowDelay="500" [matTooltip]="remote.remoteSpecs.name">
                  {{ remote.remoteSpecs.name }}
                </h4>
                <div class="status-indicators">
                  @if (remote.mountState) {
                    <div
                      class="status-dot mount"
                      [class.active]="statusService.getMountProfileCount(remote) > 0"
                      [matTooltip]="statusService.getMountTooltip(remote)"
                      matTooltipShowDelay="500"
                      [attr.aria-label]="'sidebar.aria.mountStatus' | translate"
                    >
                      <mat-icon svgIcon="mount"></mat-icon>
                      @if (statusService.getMountProfileCount(remote) > 1) {
                        <span class="count-badge">{{
                          statusService.getMountProfileCount(remote)
                        }}</span>
                      }
                    </div>
                  }

                  @if (statusService.hasSyncOperations(remote)) {
                    <div
                      class="status-dot sync-operations"
                      [class.active]="statusService.isAnySyncOperationActive(remote)"
                      [matTooltip]="statusService.getSyncOperationsTooltip(remote)"
                      matTooltipShowDelay="500"
                      [attr.aria-label]="'sidebar.aria.syncStatus' | translate"
                    >
                      <mat-icon
                        [svgIcon]="statusService.getActiveSyncOperationIcon(remote)"
                      ></mat-icon>
                      @if (statusService.getSyncProfileCount(remote) > 1) {
                        <span class="count-badge">{{
                          statusService.getSyncProfileCount(remote)
                        }}</span>
                      }
                    </div>
                  }

                  @if (remote.serveState && remote.serveState.isOnServe) {
                    <div
                      class="status-dot serve"
                      [class.active]="remote.serveState.isOnServe"
                      [matTooltip]="statusService.getServeTooltip(remote)"
                      matTooltipShowDelay="500"
                      [attr.aria-label]="'sidebar.aria.serveStatus' | translate"
                    >
                      <mat-icon svgIcon="satellite-dish"></mat-icon>
                      @if (statusService.getServeProfileCount(remote) > 1) {
                        <span class="count-badge">{{
                          statusService.getServeProfileCount(remote)
                        }}</span>
                      }
                    </div>
                  }
                </div>
              </div>

              <!-- Remote Type -->
              <div class="remote-type">
                <mat-icon [svgIcon]="iconService.getIconName(remote.remoteSpecs.type)"></mat-icon>
                {{ remote.remoteSpecs.type | titlecase }}
              </div>
            </mat-card-content>
          </mat-card>
        }
      </ul>
    }

    <!-- No Remotes State -->
    @if (filteredRemotes().length === 0) {
      <div class="no-remotes">
        <mat-icon svgIcon="server"></mat-icon>
        @if (searchTerm().trim()) {
          {{ 'sidebar.noRemotesFound' | translate: { term: searchTerm() } }}
        } @else {
          {{ 'sidebar.noRemotesConfigured' | translate }}
        }
      </div>
    }
  </div>
</div>
