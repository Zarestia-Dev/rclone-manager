<div class="sidebar">
  <!-- Header Section -->
  <div
    class="sidebar-header"
    (click)="toggleSearch()"
    matTooltip="Toggle search bar"
    aria-label="Toggle search bar"
    matTooltipShowDelay="500"
    role="button"
    tabindex="0"
  >
    <h3>
      <mat-icon svgIcon="server"></mat-icon>
      Remotes
    </h3>
  </div>

  <!-- Search Container -->
  <app-search-container
    [visible]="searchVisible()"
    [searchText]="searchTerm()"
    (searchTextChange)="onSearchTextChange($event)"
    placeholder="Search remotes..."
    ariaLabel="Search remotes"
  >
  </app-search-container>

  <!-- Scrollable Content Area -->
  <div class="content-area">
    <!-- Remote List -->
    @if (filteredRemotes().length > 0) {
      <ul>
        @for (remote of filteredRemotes(); track remote.remoteSpecs.name) {
          <mat-card
            class="remote-card"
            (click)="selectRemote(remote)"
            [class.selected]="selectedRemote()?.remoteSpecs?.name === remote.remoteSpecs.name"
          >
            <mat-card-content class="card-content">
              <!-- Remote Name with Status Indicators -->
              <div class="remote-header">
                <h4 matTooltipShowDelay="500" [matTooltip]="remote.remoteSpecs.name">
                  {{ remote.remoteSpecs.name }}
                </h4>
                <div class="status-indicators">
                  @if (remote.mountState) {
                    <div
                      class="status-dot mount"
                      [class.active]="getMountProfileCount(remote) > 0"
                      [matTooltip]="getMountTooltip(remote)"
                      matTooltipShowDelay="500"
                      aria-label="Mount status"
                    >
                      <mat-icon svgIcon="mount"></mat-icon>
                      @if (getMountProfileCount(remote) > 1) {
                        <span class="count-badge">{{ getMountProfileCount(remote) }}</span>
                      }
                    </div>
                  }

                  @if (hasSyncOperations(remote)) {
                    <div
                      class="status-dot sync-operations"
                      [class.active]="isAnySyncOperationActive(remote)"
                      [matTooltip]="getSyncOperationsTooltip(remote)"
                      matTooltipShowDelay="500"
                      aria-label="Sync operations status"
                    >
                      <mat-icon [svgIcon]="getActiveSyncOperationIcon(remote)"></mat-icon>
                      @if (getSyncProfileCount(remote) > 1) {
                        <span class="count-badge">{{ getSyncProfileCount(remote) }}</span>
                      }
                    </div>
                  }

                  @if (remote.serveState && remote.serveState.isOnServe) {
                    <div
                      class="status-dot serve"
                      [class.active]="remote.serveState.isOnServe"
                      [matTooltip]="getServeTooltip(remote)"
                      matTooltipShowDelay="500"
                      aria-label="Serve status"
                    >
                      <mat-icon svgIcon="satellite-dish"></mat-icon>
                      @if (getServeProfileCount(remote) > 1) {
                        <span class="count-badge">{{ getServeProfileCount(remote) }}</span>
                      }
                    </div>
                  }
                </div>
              </div>

              <!-- Remote Type -->
              <div class="remote-type">
                <mat-icon [svgIcon]="iconService.getIconName(remote.remoteSpecs.type)"></mat-icon>
                {{ remote.remoteSpecs.type | titlecase }}
              </div>
            </mat-card-content>
          </mat-card>
        }
      </ul>
    }

    <!-- No Remotes State -->
    @if (filteredRemotes().length === 0) {
      <div class="no-remotes">
        <mat-icon svgIcon="server"></mat-icon>
        @if (searchTerm().trim()) {
          No remotes found matching "{{ searchTerm() }}"
        } @else {
          No remotes configured
        }
      </div>
    }
  </div>
</div>
